<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Figures for the MBR Manuscript}
-->

# Figures for the MBR Manuscript
This vignette produces the graphs included in the initial MBR manuscript.

<!-- For some reason, this works better in an isolated chunk. Force knitr to use the repository's root directory as the working directory. -->
```{r set_root_dir, echo=FALSE}
require(knitr)
opts_knit$set(root.dir = "./../") 
```


```{r set_options, echo=FALSE, results='hide'}
require(knitr)
opts_chunk$set(
    comment=NA, 
    tidy=FALSE,
    fig.width=6.5, 
    fig.height=1.6,
    fig.path='figure_rmd/'
)

FigureResolution <- 60
options(width=120) #So the output is 50% wider than the default.

read_chunk("./vignettes/MbrFigures.R") 
```

<!-- Load the packages.  Suppress the output when loading packages. --> 
```{r load_packages, echo=TRUE, message=FALSE}
```


## Figure 2: Rolling Linear
Smoothed monthly birth rates (General Fertility Rates; GFRs) for Oklahoma County, 1990-1999, plotted in a linear plot.  The top plot shows the connected raw data with a February smoother; the middle plot shows smoothing with a 12-month moving average, blue/green line, superimposed on a February smoother, red line); the bottom plot shows the smoothers and confidence bands, which are H-spreads defined using the distribution of GFR's for the given month and 11 previous months.

### Individual Components
Here is the basic linear rolling graph.  It doesn't require much specification, and will work with a wide range of approriate datasets.

```{r Figure2IndividualBasic}
```

The version for the manuscript was tweak to take advantage of certain features of the dataset.

```{r Figure2IndividualStylized}
```

### Combined Panels
This is what it looks like when all three stylized panels are combined.

```{r Figure2Combined, fig.height=4.8, dpi=FigureResolution} 
```


## Figure 4: Simple Linear
Re-portrayal of the linear plot of the GFR time series in Oklahoma County.

```{r Figure4Basic}
```

```{r Figure4Stylized}
```

## Figure 5: Periodic Linear
Linear plot of the GFR time series data in Oklahoma County, with H-spread Bands superimposed.

```{r Figure5Basic}
```

```{r Figure5Stylized}
```

## Session Info
For the sake of documentation and reproducibility, the current vignette was build on a system using the following software.

```{r session_info, echo=FALSE}
cat("Report created by", Sys.info()["user"], "at", strftime(Sys.time(), "%c, %z"))
sessionInfo()
```
